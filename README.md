中鋼地磅單 AI 解析系統 (CSC Scanner)

這是一款專為中鋼（CSC）地磅單設計的行動化辨識方案。結合了前端影像處理技術與 Google Gemini AI 大模型，能將紙本磅單快速轉化為結構化的 Excel 數據。

📋 系統解析程序說明

系統的處理流程分為以下四個主要階段，確保數據的準確性與可交換性：

1. 影像預處理階段 (Image Pre-processing)

當使用者選取照片或 PDF 檔案後，系統會進行以下處理：

格式轉換：將 PDF 或多種圖片格式統一轉換為 HTML Canvas 畫布對象。

解析度校正：自動偵測圖片尺寸，將長邊縮放至 1600px 以內，在保持辨識細節與節省傳輸流量間取得平衡。

旋轉校正：提供手動旋轉功能，確保磅單文字處於水平狀態（AI 在水平文字下的辨識精度最高）。

2. AI 辨識階段 (AI Recognition)

這是系統的核心邏輯，利用視覺大型語言模型進行解析：

掃描方向設定：根據使用者選取的「左至右」或「右至左」設定，系統會調整 Prompt 指令，引導 AI 優先搜尋對應位置的流水號或日期。

上下文理解：AI 不僅辨識文字，還會判斷數據邏輯（例如：總重 - 空重 = 淨重）。

結構化輸出：要求 AI 嚴格輸出 JSON 格式，包含以下欄位：

date: 日期

material: 品名/料號

truck_id: 車號

gross_weight: 總重

empty_weight: 空重

net_weight: 淨重

serial: 磅單序號

3. 數據驗證與呈現 (Data Validation)

即時列表：解析後的結果會立即呈現於下方列表，並以卡片形式顯示關鍵數據。

異常提醒：若關鍵欄位（如車號或重量）缺失，卡片會以 --- 標示，提醒使用者檢查。

本地暫存：辨識結果暫存於記憶體中，支援單筆刪除或全部清除。

4. 數據匯出與分享 (Export & Share)

Excel 轉換：使用 xlsx.js 將 JSON 陣列轉換為標準試算表格式。

Web Share API：利用行動裝置的原生分享功能，讓使用者無需下載檔案即可直接傳送 Excel 到 LINE 群組或電子郵件。

🛠 操作注意技巧

為了獲得最佳的解析效果，請遵循以下操作建議：

拍攝穩定度：請在光線充足處拍攝，避免鏡頭晃動造成數字模糊。

填滿畫面：磅單應佔據畫面 80% 以上的區域，減少背景雜物的干擾。

對齊邊框：若磅單嚴重傾斜，請務必使用預覽圖下方的 「旋轉鈕」 將其修正至水平方向。

選擇方向：

左至右：適用於流水號位在左上角的舊版/標準格式。

右至左：適用於部分特定單據或日期位在右側的格式。

🏗 技術架構

Frontend: HTML5, Tailwind CSS (UI 佈局)

AI Engine: Google Gemini 2.5 Flash Lite (影像視覺辨識)

Library:

pdf.js: 處理 PDF 預覽與轉換

xlsx.js: 生成 Excel 報表

Deployment: GitHub Pages (PWA 模式支援)

🔒 安全性聲明

本系統採取 「金鑰本地化」 策略。使用者的 Gemini API Key 僅儲存於當前瀏覽器的 localStorage 中，不會上傳至任何第三方伺服器，確保開發者與使用者的資安疑慮降至最低。
